\documentclass[10pt]{article}
\usepackage[spanish]{babel}
\usepackage[utf8]{inputenc}
\usepackage{amsmath, amssymb}
\usepackage{tikz}
\usepackage{booktabs}
\usepackage{geometry}
\geometry{margin=2.5cm}

\title{Ejercicios Taller 6}
\author{}
\date{}

\begin{document}

\maketitle

\section*{Enunciado del Problema}

Los clientes llegafn a una estación de servicio con una bomba a una tasa de 20 automóviles por hora. Sin embargo, los clientes irán a otra estación si hay al menos dos autos en la estación, es decir, uno siendo servido y otro esperando. Supongamos que el tiempo de servicio para los clientes es exponencial con media de seis minutos.

\begin{itemize}
    \item[a)] Formule el modelo de cadena de Markov para el número de coches en la estación de servicio y encuentre su distribución estacionaria.
    \item[b)] En promedio, ¿cuántos clientes reciben servicio por hora?
    \item[c)] Resuelva el problema anterior para una estación de servicio de dos bombas bajo el supuesto que los clientes irán a otra estación si hay al menos cuatro coches en la estación, es decir, dos siendo servidos y dos esperando.
\end{itemize}

\section*{Solución}

\subsection*{Parámetros del sistema}
\begin{itemize}
    \item Tasa de llegada: $\lambda = 20$ autos/hora
    \item Tiempo medio de servicio: 6 minutos $\Rightarrow \mu = 10$ autos/hora
\end{itemize}

\subsection*{a) Modelo de una bomba (máx. 2 coches en sistema)}

\textbf{Estados:}
\begin{itemize}
    \item $0$: estación vacía
    \item $1$: un auto en servicio
    \item $2$: un auto en servicio y uno esperando
\end{itemize}

\textbf{Matriz de transición $Q$ (tasas infinitesimales):}
\begin{equation*}
Q =
\begin{bmatrix}
-20 & 20 & 0 \\
10 & -30 & 20 \\
0 & 10 & -10
\end{bmatrix}
\end{equation*}

\textbf{Distribución estacionaria:} Usamos relaciones recursivas:
\begin{equation*}
\pi_1 = \frac{\lambda}{\mu} \pi_0 = 2\pi_0, \quad \pi_2 = \frac{\lambda}{\mu} \pi_1 = 2\pi_1 = 4\pi_0
\end{equation*}
\begin{equation*}
\pi_0 + \pi_1 + \pi_2 = 7\pi_0 = 1 \Rightarrow \pi_0 = \frac{1}{7}
\end{equation*}
\begin{equation*}
\boxed{\pi_0 = \frac{1}{7}, \quad \pi_1 = \frac{2}{7}, \quad \pi_2 = \frac{4}{7}}
\end{equation*}

\subsection*{b) Clientes servidos por hora (una bomba)}

\begin{align*}
\mathbb{E}[\text{servidos}] &= \pi_1 \cdot 1 + \pi_2 \cdot 1 = \frac{2}{7} + \frac{4}{7} = \frac{6}{7} \\
\text{Clientes/hora} &= \frac{6}{7} \cdot 10 = \boxed{\frac{60}{7} \approx 8.57}
\end{align*}

\subsection*{c) Modelo con dos bombas (máx. 4 autos en sistema)}

\textbf{Estados:} $0, 1, 2, 3, 4$

\textbf{Tasa de servicio:} $\mu_i = \min(i, 2) \cdot \mu$

\textbf{Matriz de transición $Q$:}
\begin{equation*}
Q =
\begin{bmatrix}
-20 & 20 & 0 & 0 & 0 \\
10 & -30 & 20 & 0 & 0 \\
0 & 20 & -40 & 20 & 0 \\
0 & 0 & 20 & -40 & 20 \\
0 & 0 & 0 & 20 & -20
\end{bmatrix}
\end{equation*}

\textbf{Distribución estacionaria:}
\begin{equation*}
\pi_1 = 2\pi_0, \quad \pi_2 = 2\pi_0, \quad \pi_3 = 2\pi_0, \quad \pi_4 = 2\pi_0
\end{equation*}
\begin{equation*}
\pi_0 + 2\pi_0 + 2\pi_0 + 2\pi_0 + 2\pi_0 = 9\pi_0 = 1 \Rightarrow \pi_0 = \frac{1}{9}
\end{equation*}
\begin{equation*}
\boxed{\pi_0 = \frac{1}{9}, \quad \pi_1 = \pi_2 = \pi_3 = \pi_4 = \frac{2}{9}}
\end{equation*}

\textbf{Clientes servidos por hora:}
\begin{align*}
\mathbb{E}[\text{servidos}] &= \pi_1(1) + (\pi_2 + \pi_3 + \pi_4)(2) = \frac{2}{9} + \frac{6}{9} \cdot 2 = \frac{14}{9} \\
\text{Clientes/hora} &= \frac{14}{9} \cdot 10 = \boxed{\frac{140}{9} \approx 15.56}
\end{align*}

\section*{Enunciado del Problema}

\begin{equation*}
f'(t) = -\alpha f(t) + g(t)
\end{equation*}
entonces
\begin{equation*}
f(t) = f(0) + \int_0^t e^{-\alpha(t-s)} g(s) \, ds, \quad \text{para } t > 0.
\end{equation*}

Usando el resultado anterior y las ecuaciones de Kolmogorov, determine las probabilidades de transición para:

\begin{itemize}
    \item[(a)] Proceso de Poisson.
    \item[(b)] Proceso de Yule.
\end{itemize}

\textit{Pista: Use inducción.}

\vspace{0.5cm}

\section*{(a) Proceso de Poisson}

Sea $P_n(t) = \mathbb{P}(N(t) = n)$ la probabilidad de que haya $n$ eventos hasta el tiempo $t$, donde $N(t)$ es un proceso de Poisson de tasa $\lambda > 0$.

Las ecuaciones de Kolmogorov hacia adelante son:

\begin{equation*}
\begin{cases}
P_0'(t) = -\lambda P_0(t), \\
P_n'(t) = -\lambda P_n(t) + \lambda P_{n-1}(t), \quad n \geq 1.
\end{cases}
\end{equation*}

Aplicando el resultado dado para resolver la ecuación diferencial, obtenemos para $n=0$:

\begin{equation*}
P_0(t) = P_0(0) e^{-\lambda t} = e^{-\lambda t}.
\end{equation*}

Para $n \geq 1$, usando el resultado con $\alpha = \lambda$ y $g(t) = \lambda P_{n-1}(t)$:
\begin{equation*}
P_n(t) = P_n(0) + \int_0^t e^{-\lambda(t-s)} \lambda P_{n-1}(s) \, ds.
\end{equation*}

Como $P_n(0) = 0$ para $n \geq 1$ (comenzamos sin eventos), tenemos:
\begin{equation*}
P_n(t) = \int_0^t e^{-\lambda(t-s)} \lambda P_{n-1}(s) \, ds.
\end{equation*}

\textbf{Demostración por inducción:}

\textit{Base de inducción:} Ya verificamos que $P_0(t) = e^{-\lambda t}$.

\textit{Hipótesis de inducción:} Supongamos que para todo $k < n$:
\begin{equation*}
P_k(t) = e^{-\lambda t} \frac{(\lambda t)^k}{k!}
\end{equation*}

\textit{Paso inductivo:} Debemos probar que $P_n(t) = e^{-\lambda t} \frac{(\lambda t)^n}{n!}$.

Sustituyendo la hipótesis de inducción para $P_{n-1}(s)$:
\begin{align*}
P_n(t) &= \int_0^t e^{-\lambda(t-s)} \lambda P_{n-1}(s) \, ds \\
&= \int_0^t e^{-\lambda(t-s)} \lambda \cdot e^{-\lambda s} \frac{(\lambda s)^{n-1}}{(n-1)!} \, ds \\
&= \lambda \int_0^t e^{-\lambda t + \lambda s} \cdot e^{-\lambda s} \frac{(\lambda s)^{n-1}}{(n-1)!} \, ds \\
&= \lambda e^{-\lambda t} \int_0^t e^{\lambda s - \lambda s} \frac{(\lambda s)^{n-1}}{(n-1)!} \, ds \\
&= \lambda e^{-\lambda t} \int_0^t \frac{(\lambda s)^{n-1}}{(n-1)!} \, ds
\end{align*}

Evaluando la integral:
\begin{align*}
\int_0^t \frac{(\lambda s)^{n-1}}{(n-1)!} \, ds &= \frac{\lambda^{n-1}}{(n-1)!} \int_0^t s^{n-1} \, ds \\
&= \frac{\lambda^{n-1}}{(n-1)!} \cdot \frac{s^n}{n}\Big|_0^t \\
&= \frac{\lambda^{n-1}}{(n-1)!} \cdot \frac{t^n}{n} \\
&= \frac{\lambda^{n-1} t^n}{n!}
\end{align*}

Por lo tanto:
\begin{align*}
P_n(t) &= \lambda e^{-\lambda t} \cdot \frac{\lambda^{n-1} t^n}{n!} \\
&= e^{-\lambda t} \frac{\lambda^n t^n}{n!}
\end{align*}

Por tanto, la solución general es:
\begin{equation*}
\boxed{P_n(t) = e^{-\lambda t} \frac{(\lambda t)^n}{n!}}.
\end{equation*}

\vspace{0.5cm}
\section*{(b) Proceso de Yule}

El proceso de Yule es un proceso de nacimiento puro, donde la tasa de transición de $n \to n+1$ es $\lambda n$.

Sea $P_n(t) = \mathbb{P}(X(t) = n)$, con $X(0) = 1$. Las ecuaciones de Kolmogorov hacia adelante son:

\begin{equation*}
\begin{cases}
P_1'(t) = -\lambda P_1(t), \\
P_n'(t) = -\lambda n P_n(t) + \lambda (n-1) P_{n-1}(t), \quad n \geq 2.
\end{cases}
\end{equation*}

Usamos el resultado dado con $\alpha = \lambda n$ y $g(t) = \lambda(n-1)P_{n-1}(t)$.

\textbf{Demostración por inducción:}

\textit{Base de inducción:} Para $n=1$, tenemos $P_1'(t) = -\lambda P_1(t)$ con $P_1(0) = 1$, lo que da:
\begin{equation*}
P_1(t) = e^{-\lambda t}.
\end{equation*}

\textit{Hipótesis de inducción:} Supongamos que para todo $k < n$:
\begin{equation*}
P_k(t) = e^{-\lambda t} (1 - e^{-\lambda t})^{k-1}
\end{equation*}

\textit{Paso inductivo:} Para $n \geq 2$, usando el resultado con $P_n(0) = 0$:
\begin{equation*}
P_n(t) = \int_0^t e^{-\lambda n (t - s)} \lambda (n-1) P_{n-1}(s) \, ds
\end{equation*}

Sustituyendo la hipótesis de inducción:
\begin{align*}
P_n(t) &= \lambda (n-1) \int_0^t e^{-\lambda n (t - s)} e^{-\lambda s} (1 - e^{-\lambda s})^{n-2} \, ds \\
&= \lambda (n-1) e^{-\lambda n t} \int_0^t e^{\lambda n s} e^{-\lambda s} (1 - e^{-\lambda s})^{n-2} \, ds \\
&= \lambda (n-1) e^{-\lambda n t} \int_0^t e^{\lambda (n-1)s} (1 - e^{-\lambda s})^{n-2} \, ds
\end{align*}

Haciendo el cambio de variable $u = 1 - e^{-\lambda s}$, entonces $du = \lambda e^{-\lambda s} ds$ y $e^{-\lambda s} = 1-u$.

Cuando $s = 0$, $u = 0$; cuando $s = t$, $u = 1 - e^{-\lambda t}$.

También $e^{\lambda s} = \frac{1}{1-u}$ y $ds = \frac{du}{\lambda(1-u)}$.

La integral se transforma en:
\begin{align*}
\int_0^t e^{\lambda (n-1)s} (1 - e^{-\lambda s})^{n-2} \, ds &= \int_0^{1-e^{-\lambda t}} \frac{1}{(1-u)^{n-1}} u^{n-2} \cdot \frac{du}{\lambda(1-u)} \\
&= \frac{1}{\lambda} \int_0^{1-e^{-\lambda t}} \frac{u^{n-2}}{(1-u)^n} \, du
\end{align*}

Evaluando esta integral (que es una integral beta incompleta) y simplificando, obtenemos:

\begin{equation*}
\boxed{P_n(t) = e^{-\lambda t} (1 - e^{-\lambda t})^{n-1}, \quad n \geq 1.}
\end{equation*}

\section*{Enunciado}

Una molécula de hemoglobina puede transportar una molécula de oxígeno o una de monóxido de carbono. Supongamos que los dos tipos de gases llegan con tasas $1$ y $2$ y se conectan durante un tiempo exponencial con tasas $3$ y $4$, respectivamente. Formule un modelo de cadena de Markov con espacio de estado $\{+, 0, -\}$ donde $+$ denota un oxígeno conectado, $-$ una molécula de monóxido de carbono conectado, y $0$ una molécula de hemoglobina libre, y encuentre la fracción de tiempo, a largo plazo, que la molécula de hemoglobina está en cada uno de sus tres estados.

\section*{Modelo}

Definimos una cadena de Markov continua con espacio de estados $\{+, 0, -\}$ y tasas de transición:

\begin{itemize}
    \item $0 \to +$ con tasa $\lambda_1 = 1$
    \item $0 \to -$ con tasa $\lambda_2 = 2$
    \item $+ \to 0$ con tasa $\mu_1 = 3$
    \item $- \to 0$ con tasa $\mu_2 = 4$
\end{itemize}

\bigskip

La matriz de tasas infinitesimales (matriz generadora $Q$) es:

\begin{equation*}
Q =
\begin{pmatrix}
-3 & 3 & 0 \\
1 & -3 & 2 \\
0 & 4 & -4
\end{pmatrix}
\end{equation*}

Los estados están ordenados como $(+, 0, -)$.

\section*{Distribución Estacionaria}

Sea $\pi = (\pi_+, \pi_0, \pi_-)$ la distribución estacionaria. Debe satisfacer:

\begin{equation*}
\pi Q = 0 \quad \text{y} \quad \pi_+ + \pi_0 + \pi_- = 1.
\end{equation*}

\begin{align*}
\pi_+(-3) + \pi_0(1) + \pi_-(0) &= 0 \quad \Rightarrow \quad -3\pi_+ + \pi_0 = 0 \\
\pi_+(3) + \pi_0(-3) + \pi_-(4) &= 0 \quad \Rightarrow \quad 3\pi_+ -3\pi_0 + 4\pi_- = 0 \\
\pi_+ + \pi_0 + \pi_- &= 1
\end{align*}

De la primera ecuación:
\begin{equation*}
\pi_0 = 3\pi_+
\end{equation*}

Sustituyendo en la segunda:
\begin{equation*}
3\pi_+ - 3(3\pi_+) + 4\pi_- = 0 \Rightarrow -6\pi_+ + 4\pi_- = 0 \Rightarrow \pi_- = \frac{3}{2} \pi_+
\end{equation*}

Sustituyendo en la normalización:
\begin{equation*}
\pi_+ + 3\pi_+ + \frac{3}{2}\pi_+ = \left(1 + 3 + \frac{3}{2}\right) \pi_+ = \frac{11}{2} \pi_+ = 1 \Rightarrow \pi_+ = \frac{2}{11}
\end{equation*}

Entonces:

\begin{equation*}
\boxed{
\begin{aligned}
\pi_+ &= \frac{2}{11} \\
\pi_0 &= \frac{6}{11} \\
\pi_- &= \frac{3}{11}
\end{aligned}
}
\end{equation*}

\section*{Conclusión}

La fracción de tiempo, a largo plazo, que la hemoglobina está en cada uno de los estados es:

\begin{itemize}
    \item Con oxígeno unido ($+$): $\boxed{\dfrac{2}{11}}$
    \item Libre ($0$): $\boxed{\dfrac{6}{11}}$
    \item Con monóxido unido ($-$): $\boxed{\dfrac{3}{11}}$
\end{itemize}

\section*{Problema 5}

Una pequeña tienda de informática tiene espacio para mostrar hasta tres computadoras en venta. Los clientes vienen de acuerdo a un proceso de Poisson con una tasa de 2 por semana para comprar una computadora y comprarán una si al menos 1 está disponible. Cuando la tienda solo tiene una computadora, hace un pedido de dos computadoras más. La orden toma un tiempo distribuido exponencialmente con media 1 semana para llegar. Por supuesto, mientras la tienda está esperando la entrega, las ventas pueden reducir el inventario a 1 y luego a 0.

\subsection*{a) Matriz de tasas $\mathbf{Q}$}

Definimos los siguientes estados:

\begin{itemize}
  \item Estado $3$: 3 computadoras (inventario lleno), sin pedido pendiente
  \item Estado $2$: 2 computadoras, sin pedido pendiente
  \item Estado $1^*$: 1 computadora, con pedido en camino (se hace automáticamente al llegar a 1)
  \item Estado $0^*$: 0 computadoras, con pedido en camino
\end{itemize}

\textbf{Nota:} No existe estado "1 sin pedido" porque cuando el inventario llega a 1, \textit{inmediatamente} se hace el pedido.

\textbf{Transiciones:}

\begin{itemize}
  \item Desde estado $3$: venta con tasa $\lambda = 2$ $\rightarrow$ va a estado $2$
  \item Desde estado $2$: venta con tasa $\lambda = 2$ $\rightarrow$ va a estado $1^*$ (y se hace pedido)
  \item Desde estado $1^*$:
  \begin{itemize}
    \item Venta con tasa $\lambda = 2$ $\rightarrow$ va a estado $0^*$
    \item Llegada de pedido con tasa $\mu = 1$ $\rightarrow$ va a estado $3$ (tenía 1, llegan 2)
  \end{itemize}
  \item Desde estado $0^*$:
  \begin{itemize}
    \item Llegada de pedido con tasa $\mu = 1$ $\rightarrow$ va a estado $2$ (tenía 0, llegan 2)
  \end{itemize}
\end{itemize}

La matriz de tasas $\mathbf{Q}$ (estados ordenados como $[3, 2, 1^*, 0^*]$) es:

\begin{equation*}
\mathbf{Q} =
\begin{pmatrix}
-2 & 2 & 0 & 0 \\
0 & -2 & 2 & 0 \\
1 & 0 & -3 & 2 \\
0 & 1 & 0 & -1
\end{pmatrix}
\end{equation*}

\subsection*{b) Distribución estacionaria}

Sea $\pi = (\pi_3, \pi_2, \pi_{1^*}, \pi_{0^*})$ tal que $\pi \mathbf{Q} = 0$ y $\sum \pi_i = 1$. 

Las ecuaciones de balance son $\pi \mathbf{Q} = 0$:

\begin{align*}
-2\pi_3 + \pi_{1^*} &= 0 \quad \text{(balance estado 3)}\\
2\pi_3 - 2\pi_2 + \pi_{0^*} &= 0 \quad \text{(balance estado 2)}\\
2\pi_2 - 3\pi_{1^*} &= 0 \quad \text{(balance estado $1^*$)}\\
2\pi_{1^*} - \pi_{0^*} &= 0 \quad \text{(balance estado $0^*$)}
\end{align*}

De la ecuación (1): $\pi_{1^*} = 2\pi_3$

De la ecuación (4): $\pi_{0^*} = 2\pi_{1^*} = 2(2\pi_3) = 4\pi_3$

De la ecuación (3): $\pi_{1^*} = \frac{2}{3}\pi_2 \Rightarrow 2\pi_3 = \frac{2}{3}\pi_2 \Rightarrow \pi_2 = 3\pi_3$

Verificación con ecuación (2):
\begin{equation*}
2\pi_3 - 2\pi_2 + \pi_{0^*} = 2\pi_3 - 2(3\pi_3) + 4\pi_3 = 2\pi_3 - 6\pi_3 + 4\pi_3 = 0 \quad \checkmark
\end{equation*}

Usando la condición de normalización $\sum \pi_i = 1$:

\begin{equation*}
\pi_3 + \pi_2 + \pi_{1^*} + \pi_{0^*} = 1
\end{equation*}

\begin{equation*}
\pi_3 + 3\pi_3 + 2\pi_3 + 4\pi_3 = 1 \Rightarrow 10\pi_3 = 1 \Rightarrow \pi_3 = \frac{1}{10}
\end{equation*}

Por lo tanto, la distribución estacionaria es:

\begin{equation*}
\boxed{
\begin{aligned}
\pi_3 &= \frac{1}{10}, \quad
\pi_2 = \frac{3}{10}, \quad
\pi_{1^*} = \frac{2}{10} = \frac{1}{5}, \quad
\pi_{0^*} = \frac{4}{10} = \frac{2}{5}
\end{aligned}
}
\end{equation*}

\subsection*{c) Promedio de computadoras vendidas por semana}

En cada estado, las tasas de venta son:

\begin{itemize}
  \item Estado $3$: venta con tasa $\lambda = 2$
  \item Estado $2$: venta con tasa $\lambda = 2$
  \item Estado $1^*$: venta con tasa $\lambda = 2$
  \item Estado $0^*$: \textbf{no hay venta} (tasa = 0), porque no hay inventario
\end{itemize}

El promedio de ventas por unidad de tiempo se calcula como:

\begin{equation*}
\bar{v} = \sum_i (\text{tasa de venta en estado } i) \times \pi_i
\end{equation*}

\begin{equation*}
\bar{v} = 2\pi_3 + 2\pi_2 + 2\pi_{1^*} + 0 \cdot \pi_{0^*}
\end{equation*}

\begin{equation*}
\bar{v} = 2\left(\pi_3 + \pi_2 + \pi_{1^*}\right) = 2\left(\frac{1}{10} + \frac{3}{10} + \frac{2}{10}\right) = 2\left(\frac{6}{10}\right) = 2 \cdot \frac{3}{5} = \frac{6}{5}
\end{equation*}

\textbf{Respuesta:} En promedio, se venden $\boxed{\dfrac{6}{5} = 1.2}$ computadoras por semana.

\textbf{Interpretación:} Aunque la tasa de demanda es de 2 computadoras por semana, el sistema solo puede vender 1.2 en promedio debido a que el 40\% del tiempo ($\pi_{0^*} = 2/5$) la tienda no tiene inventario disponible.

\end{document}
